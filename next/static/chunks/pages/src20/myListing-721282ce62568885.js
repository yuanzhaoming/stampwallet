(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[870],{74064:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/src20/myListing",function(){return n(29338)}])},37095:function(t,e,n){"use strict";n.d(e,{Z:function(){return i}});var r=n(85893),c=n(23100),a=n(11163),s=n(31606);function i(){let t=(0,a.useRouter)();return(0,r.jsx)(c.xu,{onClick:()=>{t.back()},cursor:"pointer",children:(0,r.jsx)(s.R,{w:"25px",h:"25px"})})}},37536:function(t,e,n){"use strict";n.d(e,{m:function(){return u}});var r=n(85893),c=n(23100),a=n(26137),s=n(7754),i=n(204),o=n(95034),l=n(37095);let u=t=>(0,r.jsxs)(c.xu,{children:[(0,r.jsxs)(a.M,{columns:3,spacing:6,children:[(0,r.jsx)(c.xu,{children:(0,r.jsx)(l.Z,{})}),(0,r.jsx)(s.M,{children:t.center}),(0,r.jsxs)(i.k,{children:[(0,r.jsx)(o.L,{}),t.right]})]}),(0,r.jsx)(o.L,{mt:"30px"}),t.children]})},29338:function(t,e,n){"use strict";n.a(t,async function(t,r){try{n.r(e);var c=n(85893),a=n(29945),s=t([a]);a=(s.then?(await s)():s)[0];let i=()=>(0,c.jsx)(a.Z,{showMyListing:!0});e.default=i,r()}catch(t){r(t)}})},95542:function(t,e,n){"use strict";n.d(e,{Q$:function(){return o},T7:function(){return s},ZC:function(){return l},_q:function(){return a},fo:function(){return i}});var r=n(22085);let c=async t=>{let{network:e,method:n,params:c}=t,a={};try{a=await r.o.post("livenet"===e?"https://ancient-dark-voice.btc.discover.quiknode.pro/9429da280ed1930d3df06ba12f7f2c63a0c0f6b7/":"https://smart-palpable-road.btc-testnet.discover.quiknode.pro/12b3a078adc2d54ad643fd6f5076ede3626290cb/",{method:n,params:c})}catch(t){a=t.response}let{result:s,error:i}=a.data||{error:"Empty data"};if(i)throw Error("Query faled: ".concat(n,". Message: ").concat(i.message));return s},a=async t=>{let{queryKey:e}=t,[n,{network:c,address:a,confirmed:s}]=e;if(!a)return{};let i=await r.o.get("".concat("testnet"===c?"https://blockstream.info/testnet/api":"https://blockstream.info/api","/address/").concat(a,"/utxo"));return i.data},s=async(t,e)=>{let n=await c({network:t,params:[e],method:"sendrawtransaction"});return n},i=async(t,e)=>{let n=await c({network:t,params:[e,1],method:"getrawtransaction"});return n},o=async t=>{let{queryKey:e}=t;try{let t=await r.o.get("https://mempool.space/api/v1/fees/recommended");if(200===t.status)return t.data.fastestFee}catch(t){console.error(t)}return null},l=async t=>{let{}=t;try{let t=await r.o.get("https://www.blockchain.com/tobtc?currency=usd&value=".concat(1e3));if(200===t.status){let e=1e3/t.data;return e}}catch(t){console.error(t)}return null}},30006:function(t,e,n){"use strict";n.d(e,{Fv:function(){return s},NM:function(){return o},iA:function(){return i},ul:function(){return l},zF:function(){return a}});var r=n(22085);let c="https://pkizh327c7.execute-api.us-west-2.amazonaws.com/prod",a=async t=>{let e=await r.o.get("".concat(c,"/market/reqListMeta?tick=").concat(t));return e.data},s=async(t,e)=>{let n=await r.o.get("".concat(c,"/market/reqBuyMeta?tick=").concat(t,"&index=").concat(e));return n.data},i=async t=>{let{queryKey:e}=t,[n,{address:a}]=e;if((null==a?void 0:a.length)<10)return[];let s=await r.o.get("".concat(c,"/src20/mintByAddressV1?address=").concat(a));return s},o=async t=>{let{queryKey:e}=t,[n,{tick:a,status:s,seller:i}]=e,o="".concat(c,"/market/listing?limit=").concat(500);a&&(o+="&tick=".concat(a)),s&&(o+="&status=".concat(s)),i&&(o+="&seller=".concat(i));let l=await r.o.get(o);return l.data},l=async t=>{var e;let n={};try{n=await r.o.post("".concat(c,"/market/cancelSell"),t)}catch(t){console.error(t),n=t.response}return null===(e=n.data)||void 0===e?void 0:e.cancelled}},22085:function(t,e,n){"use strict";n.d(e,{o:function(){return c}});var r=n(6154);let c=r.Z.create({});c.interceptors.request.use(async t=>t)},96832:function(t,e,n){"use strict";n.d(e,{E8:function(){return p},JA:function(){return x},Oy:function(){return h},YI:function(){return f},Zd:function(){return d},h4:function(){return u},kA:function(){return o}});var r=n(85893),c=n(38286),a=n(7754),s=n(23100),i=n(96486);let o=1e8,{toast:l}=(0,c.I)(),u=t=>{let{title:e,status:n="info",duration:c=1e3,bgColor:i="rgba(118,177,232, 0.8)"}=t;l({title:e,status:n,duration:c,isClosable:!0,position:"top",render:t=>(0,r.jsx)(a.M,{px:"10px",children:(0,r.jsx)(s.xu,{color:"white",p:3,bg:i,borderRadius:"5px",w:"250px",children:(0,r.jsx)(a.M,{fontSize:"13px",children:e})})})})},d=t=>{let{title:e,status:n="warning",duration:r=1e3,bgColor:c="orange.400"}=t;u({title:e,status:n,duration:r,bgColor:c})},h=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return t?"".concat(t.slice(0,e),"...").concat(t.slice(t.length-e,t.length)):""},p=(t,e)=>"testnet"===e?"https://live.blockcypher.com/btc-testnet/address/".concat(t,"/"):"https://www.blockchain.com/explorer/addresses/btc/".concat(t),x=t=>{if((0,i.isEmpty)(t))return 0;let e=(0,i.sum)(t.map(t=>t.value));return e/o},f=(t,e,n)=>{var r,c;return(t=t||"",n=n||!1,r=!isNaN(e=e||0)&&parseInt(e,10)>0?parseFloat(t).toFixed(parseInt(e,10)):t,c=parseFloat(r).toString(),n&&!isNaN(c))?parseFloat(c).toLocaleString():c}},29945:function(t,e,n){"use strict";n.a(t,async function(t,r){try{n.d(e,{Z:function(){return F}});var c=n(85893),a=n(23100),s=n(7754),i=n(28129),o=n(56877),l=n(295),u=n(36354),d=n(36557),h=n(24304),p=n(36526),x=n(75421),f=n(28650),m=n(577),w=n(29222),g=n(454),y=n(77837);n(92077),n(96832);var j=n(30006),k=n(11163),v=n(96486),b=n(53403),T=n(67294),M=n(95542);n(37095);var _=n(37536),C=t([b]);function F(t){let{showMyListing:e}=t;console.log(e);let n=(0,k.useRouter)(),r=e?"":"kevin";console.log(r);let[C,F]=(0,T.useState)(""),[N,S]=(0,T.useState)(r),[q,z]=(0,T.useState)("init"),Z=b.Z.getCurrentAccount();b.Z.getNetwork();let E=null==Z?void 0:Z.address,{data:L}=(0,y.a)(["queryBtcPrice",{}],M.ZC,{refetchInterval:12e4,refetchOnWindowFocus:!1}),{data:I,isLoading:A,isFetching:O,refetch:B}=(0,y.a)(["queryListing",{tick:N,status:q,seller:E}],j.NM,{refetchInterval:18e4,refetchOnWindowFocus:!1}),P=(0,T.useMemo)(()=>(0,v.debounce)(t=>{S(t),n.push({pathname:n.pathname,query:{tick:t}},"".concat(n.pathname,"?tick=").concat(t),{shallow:!0})},1e3),[S,n]),R=t=>{F(t),P(t)};(0,T.useEffect)(()=>{var t;let e=null!==(t=n.query.tick)&&void 0!==t?t:r;F(e),S(e)},[n.query.tick,r]);let W=async t=>{let e=await (0,j.Fv)(t.tick,t.index);if(console.log(e),e.valid){let t="/src20/buy?recipient=".concat(e.address,"&message=").concat(e.message,"&btcValue=").concat(e.totalFeeInBtc);n.push(t)}},$=async t=>{let e={action:"cancel",id:t.id,seller:t.seller,timestamp:Date.now(),nonce:"".concat(Math.random())},n=await b.Z.sign(Z.ecpair,JSON.stringify(e)),r=await (0,j.ul)(n);console.log("res",r),1===r&&B(),console.log(n)};return(0,c.jsx)(_.m,{center:e?"My Listing":"Listing",right:null,children:(0,c.jsxs)(a.xu,{children:[(0,c.jsxs)(s.M,{children:["Tick:",(0,c.jsx)(i.I,{w:"100px",ml:"10px",value:C,onChange:t=>{R(t.target.value)},placeholder:"",size:"sm"}),(0,c.jsx)(o.J,{ml:"15px",as:g.riT,boxSize:"18px",cursor:"pointer",onClick:()=>{B()}})]}),O&&(0,c.jsx)(s.M,{mt:"100px",children:(0,c.jsx)(l.$,{})}),!O&&(0,c.jsx)(a.xu,{overflowY:"scroll",sx:{msOverflowStyle:"none",scrollbarWidth:"none","::-webkit-scrollbar":{display:"none"}},children:(0,c.jsx)(u.x,{py:"10px",children:(0,c.jsxs)(d.i,{variant:"simple",mt:"30px",maxW:"100px",size:"sm",children:[(0,c.jsx)(h.h,{children:(0,c.jsxs)(p.Tr,{children:[(0,c.jsx)(x.Th,{children:"Action"}),(0,c.jsx)(x.Th,{children:"Unit Price"}),(0,c.jsx)(x.Th,{children:"Amount"}),(0,c.jsx)(x.Th,{children:"Price"}),(0,c.jsx)(x.Th,{children:"Token"})]})}),(0,c.jsx)(f.p,{children:(I||[]).map((t,n)=>(0,c.jsxs)(p.Tr,{children:[(0,c.jsx)(m.Td,{children:e?(0,c.jsx)(w.z,{onClick:()=>$(t),size:"sm",variant:"link",colorScheme:"blue",disabled:!0,children:"Cancel"}):(0,c.jsx)(w.z,{onClick:()=>W(t),size:"sm",variant:"link",colorScheme:"blue",disabled:!0,children:"BUY"})}),(0,c.jsx)(m.Td,{children:L?"$"+(t.unit_price*L).toFixed(8):"loading..."}),(0,c.jsx)(m.Td,{children:t.amt}),(0,c.jsxs)(m.Td,{children:[t.price," ",L?"($"+(t.price*L).toFixed(2)+")":""]}),(0,c.jsx)(m.Td,{children:t.tick.toUpperCase()})]},n))})]})})})]})})}b=(C.then?(await C)():C)[0],r()}catch(t){r(t)}})}},function(t){t.O(0,[13,888,179],function(){return t(t.s=74064)}),_N_E=t.O()}]);
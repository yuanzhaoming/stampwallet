(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[274],{24370:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/src20/buy",function(){return n(22720)}])},5905:function(e,t,n){"use strict";n.d(t,{F:function(){return h}});var s=n(85893),i=n(89882),r=n(65291),a=n(10191),l=n(56880),c=n(88911),d=n(23100),o=n(57386),u=n(29222),x=n(67294);function h(e){let{isOpen:t,onClose:n,onConfirm:h,info:p}=e,{network:f,recipient:m,feeRate:j,feeInBtc:g,btcValue:v}=p,C=(0,x.useRef)();return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(i.a,{isOpen:t,leastDestructiveRef:C,onClose:n,p:"50px",children:(0,s.jsx)(r.Z,{p:"50px",children:(0,s.jsxs)(i._,{children:[(0,s.jsx)(a.x,{fontSize:"lg",fontWeight:"bold",children:"Send Bitcoin"}),(0,s.jsxs)(l.f,{children:[(0,s.jsx)(c.x,{children:"Confirm the transaction information:"}),(0,s.jsxs)(d.xu,{fontSize:"13px",mt:"10px",color:"gray.300",children:[(0,s.jsxs)(c.x,{children:["Network: ",f]}),(0,s.jsxs)(c.x,{children:["Recipient: ",m]}),(0,s.jsxs)(c.x,{children:["Sending: ",v," BTC"]}),(0,s.jsxs)(c.x,{children:["Fee Rate: ",j]}),(0,s.jsxs)(c.x,{children:["Transaction Fee: ",g," BTC"]})]})]}),(0,s.jsxs)(o.m,{children:[(0,s.jsx)(u.z,{ref:C,onClick:n,children:"Cancel"}),(0,s.jsx)(u.z,{onClick:h,ml:3,children:"Send"})]})]})})})})}},22720:function(e,t,n){"use strict";n.a(e,async function(e,s){try{n.r(t);var i=n(85893),r=n(68577),a=n(23100),l=n(11163),c=n(96486),d=n.n(c),o=e([r]);r=(o.then?(await o)():o)[0];let u=()=>{let e=(0,l.useRouter)(),{recipient:t,message:n,btcValue:s}=e.query;return d().isEmpty(t)||d().isEmpty(n)||d().isEmpty(s)?(0,i.jsx)(a.xu,{children:"Invalid Input"}):(0,i.jsx)(r.v,{recipientInput:t,messageInput:n,btcValueInput:s})};t.default=u,s()}catch(e){s(e)}})},68577:function(e,t,n){"use strict";n.a(e,async function(e,s){try{n.d(t,{v:function(){return k}});var i=n(85893),r=n(7335),a=n(23100),l=n(7754),c=n(88911),d=n(28129),o=n(93863),u=n(43775),x=n(204),h=n(33838),p=n(95034),f=n(29222),m=n(11163),j=n(67294),g=n(53403),v=n(37095);n(84059);var C=n(96832),y=n(77837),S=n(95542),w=n(35722),I=n(5905),b=n(30638),_=n(52636),z=e([g,w]);[g,w]=z.then?(await z)():z;let k=e=>{let{recipientInput:t,btcValueInput:n,messageInput:s}=e,z=(0,m.useRouter)(),[k,B]=(0,j.useState)(null!=t?t:""),[T,A]=(0,j.useState)(null!=n?n:""),[F,N]=(0,j.useState)(""),[E,R]=(0,j.useState)(null!=s?s:""),[O,q]=(0,j.useState)(""),[Z,L]=(0,j.useState)(),{isOpen:M,onOpen:H,onClose:J}=(0,r.q)(),[V,D]=(0,j.useState)(),P=g.Z.getCurrentAccount(),U=g.Z.getNetwork(),X=(null==P?void 0:P.address.substring(0,1))!=="b",{data:Y,isLoading:K}=(0,y.a)(["queryMempoolFee",{}],S.Q$,{refetchInterval:12e4}),Q=Y?parseInt(1.2*Y*(X?1.8:1)):void 0;(0,j.useEffect)(()=>{Q&&""===F&&N(Q)},[Q]);let{data:W,isLoading:$,isFetching:G,refetch:ee}=(0,y.a)({queryKey:["utxos",{network:U,address:null==P?void 0:P.address,confirmed:!0}],queryFn:S._q}),et=async()=>{D(!0);let e=null==P?void 0:P.ecpair;try{let{txHex:t,fee:n}=await (0,w.HB)({ecPair:e,network:U,utxos:en,toAddress:k,changeAddress:P.address,value:parseInt(T*C.kA),feeRate:F,message:E});L(t),q(n),H()}catch(e){D(!1),(0,C.Zd)({title:e.message})}},en=W||[],es=()=>{J(),D(!1)},ei=async()=>{try{let e=await (0,S.T7)(U,Z);L(null);let t=JSON.parse(await (0,b.Jt)(_.H3.ACCOUNT_ACTIVITY)||"[]");t.push({network:U,address:P.address,txId:e,date:new Date}),await (0,b.mM)(_.H3.ACCOUNT_ACTIVITY,JSON.stringify(t)),es(),z.push("/")}catch(e){(0,C.Zd)({title:e.message}),e.message.includes("conflict")&&(console.log("mempool conflict"),await ee(),et())}};return(0,i.jsxs)(a.xu,{children:[(0,i.jsx)(v.Z,{}),(0,i.jsx)(l.M,{mb:"50px",children:(0,i.jsx)(c.x,{fontSize:"15px",children:t?"Confirm Buy":"Send Bitcoin"})}),(0,i.jsx)(I.F,{isOpen:M,onClose:es,onConfirm:ei,info:{network:U,recipient:k,btcValue:T,feeRate:F,feeInBtc:O/C.kA}}),(0,i.jsx)(a.xu,{children:"Recipient Address"}),(0,i.jsx)(d.I,{mt:"5px",variant:"filled",size:"md",fontSize:"16px",placeholder:"the recipient address",value:k,disabled:t,onChange:e=>{B(e.target.value.replace(/\s\s+/g,""))}}),(0,i.jsx)(a.xu,{mt:"10px",children:"Amount of Bitcoin"}),(0,i.jsx)(d.I,{mt:"5px",variant:"filled",size:"md",placeholder:"positive decimal number",fontSize:"16px",value:T,disabled:n,onChange:e=>{A(e.target.value.replace(/[^0-9.]/g,""))}}),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.xu,{mt:"10px",children:"Message (optional)"}),(0,i.jsx)(d.I,{mt:"5px",variant:"filled",size:"md",placeholder:"leave this empty by default(max: 40)",fontSize:"16px",value:E,disabled:s,onChange:e=>{R(e.target.value.substring(0,40))}})]}),(0,i.jsx)(a.xu,{mt:"10px",children:"Fee rate"}),(0,i.jsxs)(o.B,{mt:"5px",children:[(0,i.jsx)(d.I,{variant:"filled",size:"md",placeholder:"Fee rate (satoshi per vbyte)",fontSize:"16px",value:F,onChange:e=>{N(e.target.value.replace(/[^0-9.]/g,""))}}),(0,i.jsx)(u.x,{color:"gray.300",mr:"20px",children:"sat/vB"})]}),(0,i.jsx)(a.xu,{fontSize:"14px",color:"rgb(160,171,187)",children:Y?(0,i.jsxs)(x.k,{children:["Current:",(0,i.jsxs)(h.r,{onClick:()=>{window.open("https://mempool.space/")},ml:"3px",children:[Y," sat/vB"]}),(0,i.jsx)(p.L,{}),(0,i.jsxs)(c.x,{children:[" Recommended: ",Q," sat/vB"]})]}):(0,i.jsx)(c.x,{children:"Loading fee..."})}),(0,i.jsx)(l.M,{mt:"30px",children:(0,i.jsx)(f.z,{w:"100%",isLoading:$||V,onClick:()=>{et()},children:"Send"})})]})};s()}catch(e){s(e)}})}},function(e){e.O(0,[13,888,179],function(){return e(e.s=24370)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[453],{23697:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/src20/send",function(){return n(65207)}])},801:function(e,t,n){"use strict";n.d(t,{L:function(){return h}});var s=n(85893),i=n(89882),r=n(65291),a=n(10191),l=n(56880),c=n(88911),d=n(23100),o=n(57386),x=n(29222),u=n(67294);function h(e){let{isOpen:t,onClose:n,onConfirm:h,info:p}=e,{network:f,recipient:j,feeRate:m,feeInBtc:g,token:v,amount:C}=p,S=(0,u.useRef)();return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(i.a,{isOpen:t,leastDestructiveRef:S,onClose:n,p:"50px",children:(0,s.jsx)(r.Z,{p:"50px",children:(0,s.jsxs)(i._,{children:[(0,s.jsx)(a.x,{fontSize:"lg",fontWeight:"bold",children:"Send Bitcoin"}),(0,s.jsxs)(l.f,{children:[(0,s.jsx)(c.x,{children:"Confirm the transaction information:"}),(0,s.jsxs)(d.xu,{fontSize:"13px",mt:"10px",color:"gray.300",children:[(0,s.jsxs)(c.x,{children:["Network: ",f]}),(0,s.jsxs)(c.x,{children:["Recipient: ",j]}),(0,s.jsxs)(c.x,{children:["Sending: ",C," ",v]}),(0,s.jsxs)(c.x,{children:["Fee Rate: ",m]}),(0,s.jsxs)(c.x,{children:["Transaction Fee: ",g," BTC"]})]})]}),(0,s.jsxs)(o.m,{children:[(0,s.jsx)(x.z,{ref:S,onClick:n,children:"Cancel"}),(0,s.jsx)(x.z,{onClick:h,ml:3,children:"Send"})]})]})})})})}},65207:function(e,t,n){"use strict";n.a(e,async function(e,s){try{n.r(t);var i=n(85893),r=n(88404),a=e([r]);r=(a.then?(await a)():a)[0];let l=()=>(0,i.jsx)(r.P,{});t.default=l,s()}catch(e){s(e)}})},88404:function(e,t,n){"use strict";n.a(e,async function(e,s){try{n.d(t,{P:function(){return _}});var i=n(85893),r=n(7335),a=n(23100),l=n(7754),c=n(88911),d=n(28129),o=n(93863),x=n(43775),u=n(204),h=n(33838),p=n(95034),f=n(29222),j=n(11163),m=n(67294),g=n(53403),v=n(37095),C=n(96832),S=n(77837),w=n(95542),y=n(35722),z=n(801),F=n(30638),k=n(52636),I=e([g,y]);[g,y]=I.then?(await I)():I;let _=e=>{let{listForSell:t}=e,n=(0,j.useRouter)(),[s,I]=(0,m.useState)(""),[_,T]=(0,m.useState)(""),[b,B]=(0,m.useState)(""),[N,O]=(0,m.useState)(""),[R,Z]=(0,m.useState)(""),[A,L]=(0,m.useState)(""),[P,q]=(0,m.useState)(),{isOpen:E,onOpen:M,onClose:D}=(0,r.q)(),[J,U]=(0,m.useState)(),W=g.Z.getCurrentAccount(),$=g.Z.getNetwork(),H=(null==W?void 0:W.address.substring(0,1))!=="b",{data:V,isLoading:X}=(0,S.a)(["queryMempoolFee",{}],w.Q$,{refetchInterval:12e4,refetchOnWindowFocus:!1}),{data:Y}=(0,S.a)(["queryBtcPrice",{}],w.ZC,{refetchInterval:12e4,refetchOnWindowFocus:!1}),K=V?Math.max(30,parseInt(2.3*V*(H?1.2:1))):void 0;(0,m.useEffect)(()=>{K&&""===R&&Z(K)},[K]);let{data:Q,isLoading:G,isFetching:ee,refetch:et}=(0,S.a)({queryKey:["utxos",{network:$,address:null==W?void 0:W.address,confirmed:!0}],queryFn:w._q}),en=async()=>{if(!t&&s.length<10){(0,C.Zd)({title:"Invalid recipient address"});return}if(0===_.length||_.length>5){(0,C.Zd)({title:"Invalid token"});return}if(30>parseFloat(R||"0")){(0,C.Zd)({title:"Fee cannot be lower than ".concat(30," sat/vB")});return}U(!0);let e=null==W?void 0:W.ecpair;try{let{txHex:n,fee:i}=await (0,y.gu)({ecPair:e,network:$,utxos:es,toAddress:s,changeAddress:W.address,token:_,amount:parseFloat(b),feeRate:R,sellPrice:t?N:void 0});q(n),L(i),M()}catch(e){U(!1),(0,C.Zd)({title:e.message})}},es=Q||[],ei=()=>{D(),U(!1)},er=async()=>{try{let e=await (0,w.T7)($,P);q(null);let t=JSON.parse(await (0,F.Jt)(k.H3.ACCOUNT_ACTIVITY)||"[]");t.push({network:$,address:W.address,txId:e,date:new Date}),await (0,F.mM)(k.H3.ACCOUNT_ACTIVITY,JSON.stringify(t)),ei(),n.push("/")}catch(e){(0,C.Zd)({title:e.message}),e.message.includes("conflict")&&(console.log("mempool conflict"),await et(),en())}};return(0,i.jsxs)(a.xu,{children:[(0,i.jsx)(v.Z,{}),(0,i.jsx)(l.M,{mb:"30px",children:(0,i.jsx)(c.x,{fontSize:"15px",children:t?"List SRC20 for Sell":"Send SRC20"})}),(0,i.jsx)(z.L,{isOpen:E,onClose:ei,onConfirm:er,info:{network:$,recipient:s,token:_,amount:b,feeRate:R,feeInBtc:A/C.kA}}),!t&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.xu,{children:"Recipient"}),(0,i.jsx)(d.I,{mt:"5px",variant:"filled",size:"md",fontSize:"16px",placeholder:"The recipient address",value:s,onChange:e=>{I(e.target.value.replace(/\s\s+/g,""))}})]}),(0,i.jsx)(a.xu,{mt:"10px",children:"Token"}),(0,i.jsx)(d.I,{mt:"5px",variant:"filled",size:"md",fontSize:"16px",placeholder:"case insensitive",value:_,onChange:e=>{T(e.target.value.replace(/\s\s+/g,""))}}),(0,i.jsx)(a.xu,{mt:"10px",children:"Amount"}),(0,i.jsx)(d.I,{mt:"5px",variant:"filled",size:"md",placeholder:"positive decimal number",fontSize:"16px",value:b,onChange:e=>{B(e.target.value.replace(/[^0-9.]/g,""))}}),t&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.xu,{mt:"10px",children:"Price in BTC"}),(0,i.jsxs)(o.B,{mt:"5px",children:[(0,i.jsx)(d.I,{variant:"filled",size:"md",placeholder:"total price, positive number",fontSize:"16px",value:N,onChange:e=>{O(e.target.value.replace(/[^0-9.]/g,""))}}),(0,i.jsx)(x.x,{color:"gray.300",mr:"20px",children:"BTC"})]}),Y&&N&&b&&(0,i.jsxs)(c.x,{mt:"1px",color:"rgb(160,171,187)",fontSize:"14px",children:["USD Price: $",(Y*N).toFixed(2)," ($",(Y*N/b).toFixed(6)," per token)"]})]}),(0,i.jsx)(a.xu,{mt:"10px",children:"Fee rate"}),(0,i.jsxs)(o.B,{mt:"5px",children:[(0,i.jsx)(d.I,{variant:"filled",size:"md",placeholder:"Fee rate (satoshi per vbyte)",fontSize:"16px",value:R,onChange:e=>{Z(e.target.value.replace(/[^0-9.]/g,""))}}),(0,i.jsx)(x.x,{color:"gray.300",mr:"20px",children:"sat/vB"})]}),(0,i.jsx)(a.xu,{fontSize:"14px",color:"rgb(160,171,187)",children:V?(0,i.jsxs)(u.k,{children:["Current:",(0,i.jsxs)(h.r,{onClick:()=>{window.open("https://mempool.space/")},ml:"3px",children:[V," sat/vB"]}),(0,i.jsx)(p.L,{}),(0,i.jsxs)(c.x,{children:[" Recommended: ",K," sat/vB"]})]}):(0,i.jsx)(c.x,{children:"Loading fee..."})}),(0,i.jsx)(l.M,{mt:"30px",children:(0,i.jsx)(f.z,{w:"100%",isLoading:G||J,onClick:()=>{en()},children:"Send"})})]})};s()}catch(e){s(e)}})}},function(e){e.O(0,[13,888,179],function(){return e(e.s=23697)}),_N_E=e.O()}]);